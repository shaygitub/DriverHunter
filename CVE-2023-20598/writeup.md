i reversed this driver using IDA, im not going to go over the vulnurabilities as its very clear.
i will add the decompilation of the IOCTL handler as its very clear.
i did not go over the IOCTL codes that call the 2 local sub_... functions as they are not important
for the exploit. more documentation is included in the exploitation but for understanding parameters
passing, in this driver IDA interpreted the parameters as MasterIrp[0], [1]..... for full 8 byte values
and for specific parts of 4 bytes IDA used PHYSICAL_ADDRESS structure to control the first/second 4 byte
part

![s1](https://github.com/shaygitub/VulnDrivers/assets/122000611/73de96b6-40d5-42aa-b2f2-bc41acf72bf4)
![s2](https://github.com/shaygitub/VulnDrivers/assets/122000611/d7169783-3c25-4982-8af8-7a3d4fa8d4cd)
![s3](https://github.com/shaygitub/VulnDrivers/assets/122000611/93de7ecf-bb7c-42f8-a417-b0a3bba2a3d5)
![s4](https://github.com/shaygitub/VulnDrivers/assets/122000611/caf9ba0a-6896-4f30-9f7f-ee4dfa818962)
![s5](https://github.com/shaygitub/VulnDrivers/assets/122000611/7520d652-ee47-478e-ba2a-5d4decd0ccec)
![s6](https://github.com/shaygitub/VulnDrivers/assets/122000611/cd76d711-68ac-49ff-9aef-1cf3717eb177)
![s7](https://github.com/shaygitub/VulnDrivers/assets/122000611/70afb253-33c0-44e7-9c05-edfcf548c6ec)
![s8](https://github.com/shaygitub/VulnDrivers/assets/122000611/1af8b820-9455-4edd-a6f1-0d876ddefbe9)
![s9](https://github.com/shaygitub/VulnDrivers/assets/122000611/53e30197-3aec-4173-bf22-b57051a3b7f7)

# BE WARNED:
vulnurable driver file is included
